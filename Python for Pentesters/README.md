# Python for Pentesters

### Introduction
- What other tool can be used to convert Python scripts to Windows executables? `py2exe`

### Subdomain Enumeration
- What other protocol could be used for subdomain enumeration? `DNS`
- What function does Python use to get the input from the command line? `sys.argv`

### Directory Enumeration
- How many directories can your script identify on the target system? (extensions are .html)<br />
Use the following script to enumerate directories of the target system: <br />

      import requests 
      import sys 
      
      sub_list = open("/usr/share/wordlists/PythonForPentesters/wordlist2.txt").read() 
      directories = sub_list.splitlines()
      
      for dir in directories:
          dir_enum = f"http://{sys.argv[1]}/{dir}.html" 
          r = requests.get(dir_enum)
          if r.status_code==404: 
              pass
          else:
              print("Valid directory:" ,dir_enum)
  Now run it to get the answer: <br />
  ![image](https://github.com/user-attachments/assets/9c721a30-59b9-4b7b-be84-c16735abbb03)<br />
`4`
- What is the location of the login page? `private.html`
- Where did you find a cryptic hash? `apollo.html`
- Where are the usernames located? `surfer.html`
- What is the password assigned to Rabbit?<br />
![image](https://github.com/user-attachments/assets/9f1a948d-d38b-46a6-8ec9-3362c53c873b)<br />
`LOUSYRABBO`

### Network Scanner
- What module was used to create the ARP request packets? `scapy`
- Which variable would you need to change according to your local IP block? `ip_range`
- What variable would you change to run this code on a system with the network interface named ens33? `interface`

### Port Scanner
- What protocol will most likely be using TCP port 22? `SSH`
- What module did we import to be able to use sockets? `socket`
- What function is likely to fail if we didn't import sys? `sys.stdout.flush()`
- How many ports are open on the target machine? <br />
Use the following code:

      import sys
      import socket
  
      ip = '10.10.77.196' 
      
      open_ports =[] 
      
      ports = range(1, 65535)
      
      def probe_port(ip, port, result = 1): 
        try: 
          sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM) 
          sock.settimeout(0.5) 
          r = sock.connect_ex((ip, port))   
          if r == 0: 
            result = r 
          sock.close() 
        except Exception as e: 
          pass 
        return result
      
      for port in ports: 
          sys.stdout.flush() 
          response = probe_port(ip, port) 
          if response == 0: 
              open_ports.append(port) 
      if open_ports: 
        print ("Open Ports are: ") 
        print (sorted(open_ports)) 
      else: 
        print ("Looks like no ports are open :(")
And execute it (change the target IP according to your target): <br />
![image](https://github.com/user-attachments/assets/2e316f44-2b5f-4b37-a626-8dafeab2d3b3)<br />
`3`

- What is the highest port number open on the target system? `2100`

### File Downloader
- What is the function used to connect to the target website? `requests.get()`
- What step of the Unified Cyber Kill Chain can PSexec be used in? `Lateral Movement`

### Hash Cracker
- What is the hash you found during directory enumeration? <br />
Can be found in /apollo.html: `cd13b6a6af66fb774faa589a9d18f906`
- What is the cleartext value of this hash? you can use [CrackStation](https://crackstation.net/) to crack it: `raimbow`
- Modify the script to work with SHA256 hashes. <br />
Modify the following line of code: <br />
![image](https://github.com/user-attachments/assets/e428cf07-369e-41da-aeb2-61cc8a6c516d)<br />
- Using the modified script find the cleartext value for 5030c5bd002de8713fef5daebd597620f5e8bcea31c603dccdfcdf502a57cc60<br />
![image](https://github.com/user-attachments/assets/f1d6f17b-88a7-493c-a957-563dfb64126a)<br />
`redwings`

### Keyloggers
- What package installer was used? `pip3`
- What line in this code would you change to stop the result from being printed on the screen? `keyboard.play(keys)`

### SSH Brute Forcing
- What username starting with the letter "t" did you find earlier? `tiffany`
- What is the SSH password of this user? <br />
Run the program to get the answer: `trustno1`
- What is the content of the flag.txt file? <br />
Log into tiffany's account to find out: <br />
![image](https://github.com/user-attachments/assets/a6616cf0-0369-4ff3-8f59-8714226b08ed)<br />
`THM-737390028`
